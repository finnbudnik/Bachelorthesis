
# Replication Package for: Cognitive Biases in financial decision making of individual investors: An experiment
### 08/07/2025

This replication package accompanies Budnik, Finn. "Cognitive Biases in financial decision making of individual investors: An experiment". Bachelorthesis, TU Darmstadt.

This replication package contains code to run the simulation of the experiment, transform and analyse data and create figures. Additionally, raw and transformed data is provided. 

Generally speaking, this is how I proceeded:
- Run simulation and generate data
- Extract, evaluate and transform data
- Statistical Analysis
- Figure creation

Released under the MIT License - see License
## Author

- Finn Budnik


## License

[MIT](https://choosealicense.com/licenses/mit/)


## Data availability and provenance statements
### Statement about rights

The author of the manuscript have legitimate access to and permission to use the data used in this manuscript.

### Summary of availability

- This thesis does not involve analysis of external data (i.e., no data are used or the only data are generated by the author via simulation in their code).

### Details on each data source

- All the results in the paper use experimentally generated data. Data is generated via the simulation in the code. No external data was used.
## Dataset list

| Data file | Source | Notes    |
|-----------|--------|----------|
| `data/rawdata` | Internal (Generated via simulation) | All data used is self-raised. |
| `data/transdata` | Internal (Via code) | All data used is self-generated and replicable via code.

## Computational requirements
### Software requirements

- Python 3.12.7
  - `random`
  - `streamlit` (1.37.1)
  - `pandas` (2.2.2)
  - `matplotlib` (3.9.2)
  - `requests` (2.32.3)
  - `uuid`
  - `psycopg2`
  - `os`
  - `datetime`
  - `collections`
  - `numpy` (1.26.4)
  - `itertools`
  - `scipy` (1.13.1)

### Memory and runtime requirements

#### Summary

Approximate time needed to reproduce the analyses on a standard 2025 desktop machine: 3 hours

#### Details

The code was last run on a **4-core Intel Core i5 laptop with 8 GB of RAM, MacOS version Sequoia 15.4.1**.  


## Description of programs/code


- Programs in `code/simulation` are needed to run the simulation via streamlit and connect an external supabase database.
- Files in `data/rawdata` are extracted data from the simulation.
- Programs in `code/gen` will reformat and transform raw data into further processable data.
- Files in `data/transdata` are the transformed data prepared for statistical tests.
- Programs in `code/analysis` run statistical analysis with transformed data. Results are presented in section 4 of the thesis.
- Programs in `results/graphs` generate figures with transdata and rawdata.


## Instructions to replicators
**The simulation:**

The simulation runs via streamlit and supabase. Requirements for replication are a Github, Supabase and Streamlit account. All are available for free. The simulation process is replicable. The rawdata is not.

- Upload `code/simulation/simulation_main.py` and `code/simulation/db_utils.py` to https://share.streamlit.io and provide a database connection. A connection via Github may be useful. 
**Note:** The website and the initial database referenced in the code are not active anymore.
- Database needs `data/rawdata/rawdata_stock_prices` to replicate price developments and SQL-tables to save output.
- Run the simulation and collect data.
- Download `rawdata_merged.csv`,`rawdata_action_rows` and `rawdata_stock_prices` as .csv files.
- `rawdata_action_rows_wotreat` is `rawdata_action_rows` cleaned by forced purchases. This process can easily be done with any csv-editor, for example Microsoft excel.

**To replicate the data analysis with the existing rawdata used in the thesis, continue here:**

**Data transformation:**

- Run programs in `code/gen` to transform raw data in to transformed data.
- For `code/gen/gen_de_avg_sub.py` and `code/gen/gen_ee_sub.py` code needs adjustments depending on what subsample is generated. 
- Algorithm creates all `data/transdata` .csv files.

**Data Analysis:**

- Run programs in `code/analysis` for statistical test results.
- Input reference may need to be adjusted, depending on which file is evaluated.
- The programs `code/analysis/ttest_ee.py` and `code/analysis/ttest_ee_group.py` can test different stock prices. Input is variable.
- Statistical test results are printed in the terminal.

**Figure Illustration:**

- Run `results/figures` to recreate figures used in the thesis. See following section "List of tables and figures" for further reference.
## List of tables and figures

The provided code reproduces:
- All figures in the thesis listed below.
- Tables are not provided with code.


| Figure/Table #    | Program                  | Output file                      |Source
|-------------------|--------------------------|-----------------------------------------------|---------------------------------|
| Figure 2.1           | results/graphs/graph_prospecttheory.py | graph_prospecttheory.png         | Kahneman and Tversky (1979)        
| Figure 4.1        | results/graphs/graph_de.py    |  graph_DEPGRPLR.png         ||
| Figure 4.2        | results/graphs/graph_alpha.py      |   graph_alpha.png     ||
| Figure 4.3        | results/graphs/graph_ee.py | graph_buysell.png||
| Figure 1          | results/graphs/graph_stocks.py | graph_stocks.png||

## References

- Kahneman, D. and A. Tversky (1979). “Prospect Theory: An Analysis of Decision under Risk”. In: Econometrica 47.2, pp. 263–291. issn: 00129682, 14680262. doi: https://doi.org/10.2307/1914185.
